# Rust ç¬¬ä¸€é˜¶æ®µå­¦ä¹ æ€»ç»“

æˆ‘äº 2023 å¹´ 10 æœˆ 13 æ—¥å®Œæˆå…¨éƒ¨ç»ƒä¹ ï¼Œåœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ Rust çš„å­¦ä¹ ç»å†ã€‚æœ¬æ¬¡æ€»ç»“ä¸»è¦å€ŸåŠ©äº[Rust ç¨‹åºè®¾è®¡è¯­è¨€ï¼ˆç®€ä½“ä¸­æ–‡ç‰ˆï¼‰](https://kaisery.github.io/trpl-zh-cn/title-page.html)çš„ç»„ç»‡é¡ºåºã€‚

# ä¸€ã€å®‰è£…ä¸ Cargo åŒ…

ç¬¬ä¸€èŠ‚ä¸»è¦ä»‹ç» Rust çš„å®‰è£…ä»¥åŠåŒ…ç®¡ç†å·¥å…· cargoã€‚

## å®‰è£…Â·

IDE é‡‡ç”¨ VS Codeï¼Œè¿™é‡Œçš„é‡ç‚¹æ˜¯ä¸‹è½½ rustã€‚ç®€å•çš„è¯´å°±æ˜¯æ‰§è¡Œä¸€ä¸ªè¯­å¥ï¼š

```bash
curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh
```

ç­‰å¾…å®‰è£…ç»“æŸå³å¯ã€‚æ‰§è¡Œ

```bash
rustc --version
```

å¦‚æœèƒ½å¤Ÿçœ‹åˆ°ç‰ˆæœ¬å·ï¼Œè¯æ˜å®‰è£…æ²¡æœ‰é—®é¢˜ã€‚

## Cargo åŒ…ç®¡ç†å·¥å…·

ç›´æ¥ä½¿ç”¨

```bash
cargo new hello_cargo
```

å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåç§°ä¸º hello_cargo çš„é¡¹ç›®ã€‚é…ç½®æ–‡ä»¶ä¸º Cargo.toml. Rustlings ç»ƒä¹ å·²ç»é‡‡ç”¨ cargo è¿›è¡Œç®¡ç†ï¼ŒæŸ¥çœ‹å…¶ toml æ–‡ä»¶ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†

```toml
[package]
name = "rustlings"
description = "Small exercises to get you used to reading and writing Rust code!"
version = "5.5.1"
......

[dependencies]
argh = "0.1"
indicatif = "0.16"
console = "0.15"
notify = "4.0"
......

[[bin]]
name = "rustlings"
path = "src/main.rs"

[dev-dependencies]
assert_cmd = "0.11.0"
predicates = "1.0.1"
glob = "0.3.0"


```

è¿™ä¸ª toml æ–‡ä»¶ä¾æ¬¡ä»‹ç»äº†æœ¬é¡¹ç›®çš„è‹¥å¹²ä¿¡æ¯ï¼ˆpackageï¼‰ã€ä¾èµ–ï¼ˆdeoendenciesï¼‰ã€æ‰§è¡Œå‘½ä»¤ï¼ˆbinï¼‰ã€å¼€å‘ä¾èµ–ï¼ˆdev-dependenciesï¼‰ã€‚ä¸å…¶ä»–åŒ…ç®¡ç†å·¥å…·ï¼ˆå¦‚ Mavenï¼‰ç±»ä¼¼ï¼Œéœ€è¦ä»€ä¹ˆä¾èµ–ç›´æ¥å¾€é‡Œå†™å°±è¡Œäº†ï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½ã€‚

ä¸‹é¢ä»‹ç»ä¸‹ cargo çš„å¸¸è§å‘½ä»¤ï¼š

```bash
cargo new #åˆ›å»ºé¡¹ç›®
cargo build # ç¼–è¯‘æœ¬é¡¹ç›®
cargo run  # ä¸€æ­¥æ„å»ºå¹¶è¿è¡Œé¡¹ç›®
cargo check # åœ¨ä¸ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸‹æ„å»ºé¡¹ç›®æ¥æ£€æŸ¥é”™è¯¯
```

# äºŒã€Rust åŸºæœ¬è¯­æ³•(å¸¸è§ç¼–ç¨‹æ¦‚å¿µ)

è¿™ä¸€éƒ¨åˆ†æ²¡æœ‰ä»€ä¹ˆéš¾çš„ï¼Œç†Ÿæ‚‰ä¸€ä¸‹ Rust æœ€æœ€åŸºæœ¬çš„è¯­æ³•å°±è¡Œã€‚

## å˜é‡ ä¸ å¯å˜æ€§

```rust
let a  = 10; // ä¸å¯å˜å˜é‡
let mut b = 10; //Â å¯å˜å˜é‡

// å¸¸é‡ï¼Œç”¨constå£°æ˜ï¼Œå¿…é¡»æ³¨æ˜å€¼çš„ç±»å‹ï¼Œå¸¸é‡åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­éƒ½æœ‰æ•ˆ
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;

//  éšè—ï¼ˆShadowingï¼‰ï¼Œ æ­¤æ—¶ä»»ä½•ä½¿ç”¨è¯¥å˜é‡åçš„è¡Œä¸ºä¸­éƒ½ä¼šè§†ä¸ºæ˜¯åœ¨ä½¿ç”¨ç¬¬äºŒä¸ªå˜é‡ï¼Œç›´åˆ°ä½œç”¨åŸŸç»“æŸã€‚
let spaces = "   ";
let spaces = spaces.len();
```

## æ•°æ®ç±»å‹

ä¸€å…±æœ‰ä¸¤ç±»æ•°æ®ç±»å‹å­é›†ï¼šæ ‡é‡ï¼ˆscalarï¼‰å’Œå¤åˆï¼ˆcompoundï¼‰ã€‚

### æ ‡é‡

æ ‡é‡ï¼ˆscalarï¼‰ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„å€¼ã€‚Rust æœ‰å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹ã€‚

éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œæˆ‘ä»¬ç”¨å•å¼•å·å£°æ˜ char å­—é¢é‡ï¼Œä½¿ç”¨åŒå¼•å·å£°æ˜å­—ç¬¦ä¸²å­—é¢é‡ã€‚Rust çš„ char ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ã€‚

```rust
// æ•´å‹
let a: u32 = 19;
let b: isize = 1000;

// æµ®ç‚¹å‹
//1.é»˜è®¤ä¸ºfloat64ç±»å‹
let x = 2.0;
//2.è¿˜æœ‰float32ç±»å‹å¯ä¾›é€‰æ‹©
let y: f32 = 3.0;

// å¸ƒå°”å‹
let t = true;
let f: bool = false;

// å­—ç¬¦å‹
let c = 'z';
let z: char = 'â„¤';
let heart_eyed_cat = 'ğŸ˜»';
```

### å¤åˆ

å¤åˆç±»å‹ä¸»è¦æœ‰ä¸¤ç§ï¼šå…ƒç»„å’Œæ•°ç»„ã€‚

```rust
// å…ƒç»„ç±»å‹
let tup: (i32, f64, u8) = (500, 6.4, 1);

//å…ƒç»„è®¿é—®
let five_hundred = tup.0;

// æ•°ç»„ç±»å‹
let a = [1, 2, 3, 4, 5];
let b: [i32; 5] = [1, 2, 3, 4, 5];
let c = [3; 5];

// æ•°ç»„è®¿é—®
let first = a[0];
```

## å‡½æ•°

åŸºæœ¬æ¨¡å¼å¦‚ä¸‹ï¼š

```rust
fn main() {
    let x = plus_one(5);

    println!("The value of x is: {x}");
}

fn plus_one(x: i32) -> i32 {
    x + 1
}

```

## æ§åˆ¶æµ

### if æ¡ä»¶åˆ¤æ–­

æ¡ä»¶åˆ¤æ–­åŸºæœ¬æ¨¡å¼å¦‚ä¸‹ï¼š

```rust
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}
```

<b>if</b> è¿˜å¯ä»¥ç”¨äºä¸‰å…ƒè¡¨è¾¾å¼ï¼š

```rust
let condition = true;
let number = if condition { 5 } else { 6 };
```

### å¾ªç¯

ä½¿ç”¨ loop é‡å¤æ‰§è¡Œä»£ç 

```rust
loop {
        println!("again!");
    }
```

ä»å¾ªç¯è¿”å›å€¼

```rust
let mut counter = 0;

let result = loop {
    counter += 1;

    if counter == 10 {
        break counter * 2;
    }
};
```

while æ¡ä»¶å¾ªç¯

```rust
let mut number = 3;

while number != 0 {
    println!("{number}!");

    number -= 1;
}
```

ä½¿ç”¨ for éå†é›†åˆ

```rust
let a = [10, 20, 30, 40, 50];

for element in a {
    println!("the value is: {element}");
}
```

# äºŒã€æ‰€æœ‰æƒ

å¯ä»¥è¯´æ˜¯ rust çš„ç¬¬ä¸€ä¸ªéš¾ç‚¹äº†ã€‚

é¦–å…ˆä»‹ç»ä¸€ä¸‹æ‰€æœ‰æƒçš„è§„åˆ™ï¼š

<li>Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€‚</li>
<li>å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚</li>
<li>å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚</li>

&nbsp;

å‰é¢ä»‹ç»çš„ç±»å‹éƒ½æ˜¯å·²çŸ¥å¤§å°çš„ï¼Œå¯ä»¥å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå¹¶ä¸”å½“ç¦»å¼€ä½œç”¨åŸŸæ—¶è¢«ç§»å‡ºæ ˆï¼Œå¦‚æœä»£ç çš„å¦ä¸€éƒ¨åˆ†éœ€è¦åœ¨ä¸åŒçš„ä½œç”¨åŸŸä¸­ä½¿ç”¨ç›¸åŒçš„å€¼ï¼Œå¯ä»¥å¿«é€Ÿç®€å•åœ°å¤åˆ¶å®ƒä»¬æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç‹¬ç«‹å®ä¾‹ã€‚ä¸è¿‡æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªå­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®æ¥æ¢ç´¢ Rust æ˜¯å¦‚ä½•çŸ¥é“è¯¥åœ¨ä½•æ—¶æ¸…ç†æ•°æ®çš„ã€‚

å­—ç¬¦ä¸²å­—é¢å€¼æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å…¶å†…å®¹ï¼Œæ‰€ä»¥æ–‡æœ¬è¢«ç›´æ¥ç¡¬ç¼–ç è¿›æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚Â  ä½†æ˜¯ï¼ŒString ç±»å‹ç®¡ç†è¢«åˆ†é…åˆ°å †ä¸Šçš„æ•°æ®ï¼Œæ‰€ä»¥èƒ½å¤Ÿå­˜å‚¨åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„æ–‡æœ¬ã€‚

é¦–å…ˆçœ‹ä¸€ä¸‹å˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ã€‚

## ç§»åŠ¨

```rust
fn main() {
    let x = 5;
    let y = x;
}
```

è¿™ä¸¤ä¸ªå˜é‡éƒ½èƒ½å¤Ÿè¢«è®¿é—®ï¼Œå› ä¸ºåŸºæœ¬ç±»å‹å­˜å‚¨åœ¨æ ˆä¸­ã€‚

```rust
let s1 = String::from("hello");
let s2 = s1;
```

è¿™ä¸¤ä¸ªå˜é‡åªæœ‰ s2 èƒ½å¤Ÿè¢«è®¿é—®ï¼Œè¿™é‡Œç›¸å½“äºåœ¨æ ˆå†…å­˜è¿›è¡Œæµ…å¤åˆ¶ï¼ˆåœ¨ Rust é‡Œå«ç§»åŠ¨ï¼‰,ä¸ºäº†é¿å…äºŒæ¬¡é‡Šæ”¾ç­‰é—®é¢˜ï¼ŒRust è®¤ä¸º s1 ä¸å†æœ‰æ•ˆï¼Œä¹‹åä¸èƒ½å†æ¬¡è®¿é—® s1ï¼Œå› æ­¤ Rust ä¸éœ€è¦åœ¨ s1 ç¦»å¼€ä½œç”¨åŸŸåæ¸…ç†ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœè®¿é—® s1 é‚£å°±å‘ç”Ÿäº†æ‰€æœ‰æƒçš„é”™è¯¯ã€‚

## å…‹éš†

å…‹éš†ç›¸å½“äºæ·±æ‹·è´ã€‚

```rust
fn main() {
    let s1 = String::from("hello");
    let s2 = s1.clone();

    println!("s1 = {}, s2 = {}", s1, s2);
}

```

è¿™é‡Œä¸¤ä¸ªå˜é‡ s1, s2 éƒ½èƒ½å¤Ÿè¢«è®¿é—®ã€‚

åœ¨æ ˆä¸­å­˜å‚¨çš„æ•°æ®ï¼Œéƒ½å¯ä»¥çœ‹ä½œå…‹éš†ã€‚

## Copy Trait

Rust æœ‰ä¸€ä¸ªå«åš Copy trait çš„ç‰¹æ®Šæ³¨è§£ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¼¼æ•´å‹è¿™æ ·çš„å­˜å‚¨åœ¨æ ˆä¸Šçš„ç±»å‹ä¸Šï¼ˆç¬¬åç« å°†ä¼šè¯¦ç»†è®²è§£ traitï¼‰ã€‚å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº† Copy traitï¼Œé‚£ä¹ˆä¸€ä¸ªæ—§çš„å˜é‡åœ¨å°†å…¶èµ‹å€¼ç»™å…¶ä»–å˜é‡åä»ç„¶å¯ç”¨ã€‚

é‚£ä¹ˆå“ªäº›ç±»å‹å®ç°äº† Copy trait å‘¢ï¼Ÿä»»ä½•ä¸€ç»„ç®€å•æ ‡é‡å€¼çš„ç»„åˆéƒ½å¯ä»¥å®ç° Copyï¼Œä»»ä½•ä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹éƒ½å¯ä»¥å®ç° Copy ã€‚å¦‚ä¸‹æ˜¯ä¸€äº› Copy çš„ç±»å‹ï¼š

<li>æ‰€æœ‰æ•´æ•°ç±»å‹</li>
<li>å¸ƒå°”ç±»å‹</li>
<li>æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹</li>
<li>å­—ç¬¦ç±»å‹ï¼Œchar</lu>
<li>å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½å®ç° Copyã€‚æ¯”å¦‚ï¼Œ(i32, i32) å®ç°äº† Copyï¼Œä½† (i32, String) å°±æ²¡æœ‰ã€‚</li>

## å¼•ç”¨ä¸å€Ÿç”¨

æˆ‘ä»¬æœ‰æ—¶å¸Œæœ›åœ¨å‡½æ•°è°ƒç”¨ä¹‹åç»§ç»­ä½¿ç”¨å‡½æ•°å‚æ•°ï¼Œä½†ç”±äºæ‰€æœ‰æƒçš„å­˜åœ¨ï¼Œè¿™è¿™ç§æ“ä½œå˜å¾—å¤æ‚äº†å¾ˆå¤šã€‚

å¼•ç”¨ï¼ˆreferenceï¼‰åƒä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç”±æ­¤è®¿é—®å‚¨å­˜äºè¯¥åœ°å€çš„å±äºå…¶ä»–å˜é‡çš„æ•°æ®ã€‚ ä¸æŒ‡é’ˆä¸åŒï¼Œå¼•ç”¨ç¡®ä¿æŒ‡å‘æŸä¸ªç‰¹å®šç±»å‹çš„æœ‰æ•ˆå€¼ã€‚

çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š

```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```

`&s1` è¯­æ³•è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª æŒ‡å‘ å€¼ `s1` çš„å¼•ç”¨ï¼Œä½†æ˜¯å¹¶ä¸æ‹¥æœ‰å®ƒã€‚å› ä¸ºå¹¶ä¸æ‹¥æœ‰è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥å½“å¼•ç”¨åœæ­¢ä½¿ç”¨æ—¶ï¼Œå®ƒæ‰€æŒ‡å‘çš„å€¼ä¹Ÿä¸ä¼šè¢«ä¸¢å¼ƒã€‚åŒç†ï¼Œå‡½æ•°ç­¾åä½¿ç”¨ & æ¥è¡¨æ˜å‚æ•° s çš„ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„è¡Œä¸ºç§°ä¸º å€Ÿç”¨ï¼ˆborrowingï¼‰ã€‚ä¸å¯ä»¥é€šè¿‡å€Ÿç”¨çš„æ–¹å¼ä¿®æ”¹ä¸å¯å˜å˜é‡ã€‚åŒæ ·ï¼Œä¸€ä¸ªå¯å˜å˜é‡ä¸èƒ½æ‹¥æœ‰ä¸¤ä¸ªå¯å˜å¼•ç”¨ï¼Œå¦‚ä¸‹é¢çš„ç¨‹åºæ˜¯é”™çš„ã€‚è¿™æ ·æ˜¯ä¸ºäº†é¿å…æ•°æ®ç«äº‰ã€‚

```rust
// è¿™æ˜¯ä¸€ä¸ªé”™è¯¯çš„ç¨‹åº
fn main() {
    let mut s = String::from("hello");

    let r1 = &mut s;
    let r2 = &mut s;

    println!("{}, {}", r1, r2);
}

```

åŒæ ·çš„ï¼Œåœ¨åŒä¸€ä½œç”¨åŸŸå†…ä¹Ÿä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶æ‹¥æœ‰å¯å˜å¼•ç”¨ã€‚

```rust
// è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé”™è¯¯çš„ç¨‹åº
fn main() {
    let mut s = String::from("hello");

    let r1 = &s; // æ²¡é—®é¢˜
    let r2 = &s; // æ²¡é—®é¢˜
    let r3 = &mut s; // å¤§é—®é¢˜

    println!("{}, {}, and {}", r1, r2, r3);
}
```

## slice

slice å…è®¸ä½ å¼•ç”¨é›†åˆä¸­ä¸€æ®µè¿ç»­çš„å…ƒç´ åºåˆ—ï¼Œè€Œä¸ç”¨å¼•ç”¨æ•´ä¸ªé›†åˆã€‚slice æ˜¯ä¸€ç±»å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰æ‰€æœ‰æƒã€‚

### å­—ç¬¦ä¸² slice

å­—ç¬¦ä¸² slice æ˜¯ String ä¸­ä¸€éƒ¨åˆ†å€¼çš„å¼•ç”¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```rust
fn main() {
    let s = String::from("hello world");

    let hello = &s[0..5];
    let world = &s[6..11];
}

```

éœ€è¦æŒ‡å‡ºä¸€ç‚¹çš„æ˜¯ï¼Œå­—ç¬¦ä¸²å­—é¢å€¼çš„ç±»å‹å°±æ˜¯å­—ç¬¦ä¸² sliceï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ str ç±»å‹æ˜¯ä¸å¯å˜çš„ã€‚

### å…¶ä»–ç±»å‹ slice

ä¸‹é¢æ˜¯ i32 æ•°ç»„çš„ä¸€ä¸ªä¾‹å­ï¼š

```rust
#![allow(unused)]
fn main() {
    let a = [1, 2, 3, 4, 5];

    let slice = &a[1..3];

    assert_eq!(slice, &[2, 3]);
}

```

# ä¸‰ã€ç»“æ„ä½“ä¸æšä¸¾

ç»“æ„ä½“å’Œæšä¸¾å˜åŒ–ä¸å¤§ï¼Œä½†æ˜¯éœ€è¦çŸ¥é“å¦‚ä½•ç”¨æšä¸¾å¤„ç†æ•°æ®ã€‚

## ç»“æ„ä½“

é¦–å…ˆç»™å‡ºç»“æ„ä½“çš„å®šä¹‰æ–¹å¼

```rust
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```

ä¸ºäº†ä»ç»“æ„ä½“ä¸­è·å–æŸä¸ªç‰¹å®šçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ç‚¹å·ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæƒ³è¦ç”¨æˆ·çš„é‚®ç®±åœ°å€ï¼Œå¯ä»¥ç”¨ user1.emailã€‚å¦‚æœç»“æ„ä½“çš„å®ä¾‹æ˜¯å¯å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‚¹å·å¹¶ä¸ºå¯¹åº”çš„å­—æ®µèµ‹å€¼ï¼Œä½†æ˜¯ Rust å¹¶ä¸å…è®¸åªå°†æŸä¸ªå­—æ®µæ ‡è®°ä¸ºå¯å˜ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚

```rust
 let mut user1 = User {
        active: true,
        username: String::from("someusername123"),
        email: String::from("someone@example.com"),
        sign_in_count: 1,
    };

    user1.email = String::from("anotheremail@example.com");
```

ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªç»“æ„ä½“ç»™å¦ä¸€ç»“æ„ä½“èµ‹å€¼ï¼š

```rust
 let user2 = User {
        email: String::from("another@example.com"),
        ..user1
    };
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ u1 å­—æ®µçš„æ‰€æœ‰æƒå‘ç”Ÿäº†å˜åŒ–ï¼Œå› æ­¤ä¸èƒ½å†ä½¿ç”¨ u1ã€‚

### å…ƒç»„ç»“æ„ä½“

å…ƒç»„ç»“æ„ä½“æœ‰ç€ç»“æ„ä½“åç§°æä¾›çš„å«ä¹‰ï¼Œä½†æ²¡æœ‰å…·ä½“çš„å­—æ®µåï¼Œåªæœ‰å­—æ®µçš„ç±»å‹ã€‚

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

fn main() {
    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}
```

å…ƒç»„ç»“æ„ä½“å®ä¾‹ç±»ä¼¼äºå…ƒç»„ï¼Œå¯ä»¥å°†å®ƒä»¬è§£æ„ä¸ºå•ç‹¬çš„éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ . åè·Ÿç´¢å¼•æ¥è®¿é—®å•ç‹¬çš„å€¼ï¼Œç­‰ç­‰ã€‚

### ç±»å•å…ƒç»“æ„ä½“ï¼ˆunit-like structsï¼‰

ç›®å‰æˆ‘ä¸çŸ¥é“è¿™ä¸ªä¸œè¥¿æœ‰ä»€ä¹ˆç”¨ï¼Œæ‰€ä»¥å…ˆæ”¾åœ¨è¿™é‡Œã€‚

```rust
struct AlwaysEqual;

fn main() {
    let subject = AlwaysEqual;
}

```

## ç»“æ„ä½“æ–¹æ³•

ç»“æ„ä½“ç›¸å…³æ–¹æ³•éœ€è¦æ”¾åœ¨ impl å—ä¸­ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚self å‰é¢çš„&è¡¨ç¤ºåªè·å¾—å€¼ä¸è·å¾—æ‰€æœ‰æƒã€‚

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn width(&self) -> bool {
        self.width > 0
    }
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    if rect1.width() {
        println!("The rectangle has a nonzero width; it is {}", rect1.width);
    }
}

```

Rust è¯­è¨€ä¸åƒ C++ç­‰æœ‰ä¸“é—¨çš„->ç¬¦å·ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨ã€‚å½“ä½¿ç”¨æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®¤ä¸ºåŠ ä¸Š&ã€&mut æˆ– \* æ¥ä½¿ç±»å‹åŒ¹é…ã€‚

## æšä¸¾

Rust çš„æšä¸¾åŠŸèƒ½æ ¼å¤–å¼ºå¤§ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„å¤„ç†ä¸åŒè¿”å›å€¼ï¼Œæ— è®ºè¿”å›çš„æ˜¯ç©ºï¼Œæ˜¯æ•°å€¼ï¼Œè¿˜æ˜¯å‡½æ•°ã€‚

æšä¸¾åŠŸèƒ½çš„å®šä¹‰å¦‚ä¸‹ï¼š

```rust
enum IpAddrKind {
    V4,
    V6,
}
```

æˆ‘ä»¬å¯ä»¥å°†ä»»æ„ç±»å‹çš„æ•°æ®æ”¾å…¥æšä¸¾æˆå‘˜ä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸å…¶ä»–è¯­è¨€æšä¸¾ç±»å‹ä¸åŒçš„åœ°æ–¹ã€‚

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}
```

### match

æˆ‘ä»¬é‡‡ç”¨ match è¯­å¥è¿›è¡Œæšä¸¾çš„åŒ¹é…ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```rust
#[derive(Debug)]
enum UsState {
    Alabama,
    Alaska,
    // --snip--
}

enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter(UsState),
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter(state) => {
            println!("State quarter from {:?}!", state);
            25
        }
    }
}

fn main() {
    value_in_cents(Coin::Quarter(UsState::Alaska));
}

```

è¿™é‡Œ match éœ€è¦ç©·ä¸¾æ‰€æœ‰å¯èƒ½å€¼ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬åªéœ€è¦éƒ¨åˆ†ç»“æœã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»Ÿé…æ¨¡å¼æˆ–è€…å ä½ç¬¦æ¥ç»™å‡ºé»˜è®¤ç»“æœã€‚

```rust
fn main() {
    let dice_roll = 9;
    match dice_roll {
        3 => 3,
        7 => 7,
        _ => (),
    }

}
```

### if let

if let è¯­å¥å¯ä»¥è®©æˆ‘ä»¬åªä¸“æ³¨äºæŸä¸€ç‰¹å®šç±»å‹ã€‚å®ƒçš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚

```rust

fn main() {
    let coin = Coin::Penny;
    let mut count = 0;
    if let Coin::Quarter(state) = coin {
        println!("State quarter from {:?}!", state);
    } else {
        count += 1;
    }
}
```

è¿™ä¸ªç¨‹åºåªæœ‰å½“ç±»å‹åŒ¹é…æ—¶æ‰ä¼šæ‰“å°è¯­å¥ã€‚

# å››ã€åŒ…ç®¡ç†

Rust æœ‰è®¸å¤šåŠŸèƒ½å¯ä»¥è®©æˆ‘ä»¬ç®¡ç†ä»£ç çš„ç»„ç»‡ï¼ŒåŒ…æ‹¬å“ªäº›å†…å®¹å¯ä»¥è¢«å…¬å¼€ï¼Œå“ªäº›å†…å®¹ä½œä¸ºç§æœ‰éƒ¨åˆ†ï¼Œä»¥åŠç¨‹åºæ¯ä¸ªä½œç”¨åŸŸä¸­çš„åå­—ã€‚è¿™äº›åŠŸèƒ½ã€‚è¿™æœ‰æ—¶è¢«ç§°ä¸º â€œæ¨¡å—ç³»ç»Ÿï¼ˆthe module systemï¼‰â€ï¼ŒåŒ…æ‹¬ï¼š

<li>åŒ…ï¼ˆPackagesï¼‰ï¼šå…è®¸æˆ‘ä»¬æ„å»ºã€æµ‹è¯•å’Œåˆ†äº« crateã€‚</li>
<li>Crates ï¼šä¸€ä¸ªæ¨¡å—çš„æ ‘å½¢ç»“æ„ï¼Œå®ƒå½¢æˆäº†åº“æˆ–äºŒè¿›åˆ¶é¡¹ç›®ã€‚</li>
<li>æ¨¡å—ï¼ˆModulesï¼‰å’Œ useï¼šå…è®¸ä½ æ§åˆ¶ä½œç”¨åŸŸå’Œè·¯å¾„çš„ç§æœ‰æ€§ã€‚</li>
<li>è·¯å¾„ï¼ˆpathï¼‰ï¼šä¸€ä¸ªå‘½åä¾‹å¦‚ç»“æ„ä½“ã€å‡½æ•°æˆ–æ¨¡å—ç­‰é¡¹çš„æ–¹å¼.</li>

### åŒ…å’Œ Carte

é¦–å…ˆä»‹ç»ä¸€ä¸‹ crateã€‚

crate æ˜¯ Rust åœ¨ç¼–è¯‘æ—¶æœ€å°çš„ä»£ç å•ä½ã€‚å¦‚æœç”¨ rustc è€Œä¸æ˜¯ cargo æ¥ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶ï¼Œç¼–è¯‘å™¨è¿˜æ˜¯ä¼šå°†é‚£ä¸ªæ–‡ä»¶è®¤ä½œä¸€ä¸ª crateã€‚crate å¯ä»¥åŒ…å«æ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å®šä¹‰åœ¨å…¶ä»–æ–‡ä»¶ï¼Œç„¶åå’Œ crate ä¸€èµ·ç¼–è¯‘ã€‚

crate æœ‰ä¸¤ç§å½¢å¼ï¼šäºŒè¿›åˆ¶é¡¹å’Œåº“ã€‚äºŒè¿›åˆ¶é¡¹å¯ä»¥è¢«ç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºæˆ–è€…ä¸€ä¸ªæœåŠ¡å™¨ã€‚å®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ª main å‡½æ•°æ¥å®šä¹‰å½“ç¨‹åºè¢«æ‰§è¡Œçš„æ—¶å€™æ‰€éœ€è¦åšçš„äº‹æƒ…ã€‚ç›®å‰æˆ‘ä»¬æ‰€åˆ›å»ºçš„ crate éƒ½æ˜¯äºŒè¿›åˆ¶é¡¹ã€‚

crate root æ˜¯ä¸€ä¸ªæºæ–‡ä»¶ï¼ŒRust ç¼–è¯‘å™¨ä»¥å®ƒä¸ºèµ·å§‹ç‚¹ã€‚å½“ç¼–è¯‘ä¸€ä¸ª crate, ç¼–è¯‘å™¨é¦–å…ˆåœ¨ crate æ ¹æ–‡ä»¶ï¼ˆé€šå¸¸ï¼Œå¯¹äºä¸€ä¸ªåº“ crate è€Œè¨€æ˜¯ src/lib.rsï¼Œå¯¹äºä¸€ä¸ªäºŒè¿›åˆ¶ crate è€Œè¨€æ˜¯ src/main.rsï¼‰ä¸­å¯»æ‰¾éœ€è¦è¢«ç¼–è¯‘çš„ä»£ç ã€‚

ä¸‹é¢çœ‹ä¸€ä¸‹åŒ…ã€‚

åŒ…ï¼ˆpackageï¼‰æ˜¯æä¾›ä¸€ç³»åˆ—åŠŸèƒ½çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ª crateã€‚ä¸€ä¸ªåŒ…ä¼šåŒ…å«ä¸€ä¸ª Cargo.toml æ–‡ä»¶ï¼Œé˜è¿°å¦‚ä½•å»æ„å»ºè¿™äº› crateã€‚Cargo å°±æ˜¯ä¸€ä¸ªåŒ…å«æ„å»ºä½ ä»£ç çš„äºŒè¿›åˆ¶é¡¹çš„åŒ…ã€‚Cargo ä¹ŸåŒ…å«è¿™äº›äºŒè¿›åˆ¶é¡¹æ‰€ä¾èµ–çš„åº“ã€‚å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ç”¨ Cargo åº“æ¥å®ç°ä¸ Cargo å‘½ä»¤è¡Œç¨‹åºä¸€æ ·çš„é€»è¾‘ã€‚

åŒ…ä¸­å¯ä»¥åŒ…å«è‡³å¤šä¸€ä¸ªåº“ crate(library crate)ã€‚åŒ…ä¸­å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªäºŒè¿›åˆ¶ crate(binary crate)ï¼Œä½†æ˜¯å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ª crateï¼ˆæ— è®ºæ˜¯åº“çš„è¿˜æ˜¯äºŒè¿›åˆ¶çš„ï¼‰ã€‚

### åŒ…ç®¡ç†æµç¨‹

ç›´æ¥ç…§æŠ„åŸæ–‡æ¥æ¦‚è¿°åŒ…ç®¡ç†å·¥ä½œçš„æµç¨‹ã€‚

<li>ä» crate æ ¹èŠ‚ç‚¹å¼€å§‹: å½“ç¼–è¯‘ä¸€ä¸ª crate, ç¼–è¯‘å™¨é¦–å…ˆåœ¨ crate æ ¹æ–‡ä»¶ï¼ˆé€šå¸¸ï¼Œå¯¹äºä¸€ä¸ªåº“ crate è€Œè¨€æ˜¯src/lib.rsï¼Œå¯¹äºä¸€ä¸ªäºŒè¿›åˆ¶ crate è€Œè¨€æ˜¯src/main.rsï¼‰ä¸­å¯»æ‰¾éœ€è¦è¢«ç¼–è¯‘çš„ä»£ç ã€‚</li>

<li>å£°æ˜æ¨¡å—: åœ¨ crate æ ¹æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥å£°æ˜ä¸€ä¸ªæ–°æ¨¡å—ï¼›æ¯”å¦‚ï¼Œä½ ç”¨mod gardenå£°æ˜äº†ä¸€ä¸ªå«åšgardençš„æ¨¡å—ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä¸‹åˆ—è·¯å¾„ä¸­å¯»æ‰¾æ¨¡å—ä»£ç ï¼š

1. å†…è”ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå½“ mod garden åæ–¹ä¸æ˜¯ä¸€ä¸ªåˆ†å·è€Œæ˜¯ä¸€ä¸ªå¤§æ‹¬å·ã€‚
2. åœ¨æ–‡ä»¶ src/garden.rs
3. åœ¨æ–‡ä»¶ src/garden/mod.rs
</li>

<li>å£°æ˜å­æ¨¡å—: åœ¨é™¤äº† crate æ ¹èŠ‚ç‚¹ä»¥å¤–çš„å…¶ä»–æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰å­æ¨¡å—ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½åœ¨src/garden.rsä¸­å®šä¹‰äº†mod vegetables;ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä»¥çˆ¶æ¨¡å—å‘½åçš„ç›®å½•ä¸­å¯»æ‰¾å­æ¨¡å—ä»£ç ï¼š

1. å†…è”ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå½“ mod vegetables åæ–¹ä¸æ˜¯ä¸€ä¸ªåˆ†å·è€Œæ˜¯ä¸€ä¸ªå¤§æ‹¬å·ã€‚
2. åœ¨æ–‡ä»¶ src/garden/vegetables.rs
3. åœ¨æ–‡ä»¶ src/garden/vegetables/mod.rs
</li>

<li>æ¨¡å—ä¸­çš„ä»£ç è·¯å¾„: ä¸€æ—¦ä¸€ä¸ªæ¨¡å—æ˜¯ä½  crate çš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯ä»¥åœ¨éšç§è§„åˆ™å…è®¸çš„å‰æä¸‹ï¼Œä»åŒä¸€ä¸ª crate å†…çš„ä»»æ„åœ°æ–¹ï¼Œé€šè¿‡ä»£ç è·¯å¾„å¼•ç”¨è¯¥æ¨¡å—çš„ä»£ç ã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œä¸€ä¸ª garden vegetables æ¨¡å—ä¸‹çš„Asparagusç±»å‹å¯ä»¥åœ¨crate::garden::vegetables::Asparagusè¢«æ‰¾åˆ°ã€‚
</li>

<li>ç§æœ‰ vs å…¬ç”¨: ä¸€ä¸ªæ¨¡å—é‡Œçš„ä»£ç é»˜è®¤å¯¹å…¶çˆ¶æ¨¡å—ç§æœ‰ã€‚ä¸ºäº†ä½¿ä¸€ä¸ªæ¨¡å—å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜æ—¶ä½¿ç”¨pub modæ›¿ä»£modã€‚ä¸ºäº†ä½¿ä¸€ä¸ªå…¬ç”¨æ¨¡å—å†…éƒ¨çš„æˆå‘˜å…¬ç”¨ï¼Œåº”å½“åœ¨å£°æ˜å‰ä½¿ç”¨pubã€‚
</li>

<li>use å…³é”®å­—: åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œuseå…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªæˆå‘˜çš„å¿«æ·æ–¹å¼ï¼Œç”¨æ¥å‡å°‘é•¿è·¯å¾„çš„é‡å¤ã€‚åœ¨ä»»ä½•å¯ä»¥å¼•ç”¨crate::garden::vegetables::Asparagusçš„ä½œç”¨åŸŸï¼Œä½ å¯ä»¥é€šè¿‡ use crate::garden::vegetables::Asparagus;åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œç„¶åä½ å°±å¯ä»¥åœ¨ä½œç”¨åŸŸä¸­åªå†™Asparagusæ¥ä½¿ç”¨è¯¥ç±»å‹ã€‚</li>

åœ¨å†—é•¿çš„æ–‡å­—å™è¿°ä¹‹åï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„åŒ…ç®¡ç†ä¾‹å­ã€‚

```rust
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}
        fn seat_at_table() {}
    }

    mod serving {
        fn take_order() {}
        fn serve_order() {}
        fn take_payment() {}
    }
}
```

å®ƒçš„åŒ…ç®¡ç†æ ‘å½¢ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

```text
crate
 â””â”€â”€ front_of_house
     â”œâ”€â”€ hosting
     â”‚   â”œâ”€â”€ add_to_waitlist
     â”‚   â””â”€â”€ seat_at_table
     â””â”€â”€ serving
         â”œâ”€â”€ take_order
         â”œâ”€â”€ serve_order
         â””â”€â”€ take_payment

```

### åŒ…ç®¡ç†è·¯å¾„

ä¸æ–‡ä»¶ç³»ç»Ÿç›¸åŒï¼ŒRust åŒ…ç®¡ç†è·¯å¾„ä¹Ÿåˆ†ä¸ºç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„ã€‚

<li>ç»å¯¹è·¯å¾„ï¼ˆabsolute pathï¼‰æ˜¯ä»¥ crate æ ¹ï¼ˆrootï¼‰å¼€å¤´çš„å…¨è·¯å¾„ï¼›å¯¹äºå¤–éƒ¨ crate çš„ä»£ç ï¼Œæ˜¯ä»¥ crate åå¼€å¤´çš„ç»å¯¹è·¯å¾„ï¼Œå¯¹äºå½“å‰ crate çš„ä»£ç ï¼Œåˆ™ä»¥å­—é¢å€¼ crate å¼€å¤´ã€‚</li>
<li>ç›¸å¯¹è·¯å¾„ï¼ˆrelative pathï¼‰ä»å½“å‰æ¨¡å—å¼€å§‹ï¼Œä»¥ selfã€super æˆ–å½“å‰æ¨¡å—çš„æ ‡è¯†ç¬¦å¼€å¤´ã€‚</li>

ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```rust
pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    front_of_house::hosting::add_to_waitlist();
}
```

### pub å±æ€§

å½“ç„¶ã€‚åœ¨ä¸åŠ  pub å±æ€§çš„æƒ…å†µä¸‹ä¸Šé¢çš„ä»£ç ç¼–è¯‘ä¸äº†ï¼Œèƒ½é€šè¿‡ç¼–è¯‘çš„ç‰ˆæœ¬å¦‚ä¸‹æ‰€ç¤ºã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

pub fn eat_at_restaurant() {
    // ç»å¯¹è·¯å¾„
    crate::front_of_house::hosting::add_to_waitlist();

    // ç›¸å¯¹è·¯å¾„
    front_of_house::hosting::add_to_waitlist();
}

```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¨¡å—å…¬æœ‰å¹¶ä¸ä½¿å…¶å†…å®¹ä¹Ÿæ˜¯å…¬æœ‰çš„ã€‚æ¨¡å—ä¸Šçš„ pub å…³é”®å­—åªå…è®¸å…¶çˆ¶æ¨¡å—å¼•ç”¨å®ƒï¼Œè€Œä¸å…è®¸è®¿é—®å†…éƒ¨ä»£ç ã€‚å› ä¸ºæ¨¡å—æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œåªæ˜¯å°†æ¨¡å—å˜ä¸ºå…¬æœ‰èƒ½åšçš„å…¶å®å¹¶ä¸å¤ªå¤šï¼›åŒæ—¶éœ€è¦æ›´æ·±å…¥åœ°é€‰æ‹©å°†ä¸€ä¸ªæˆ–å¤šä¸ªé¡¹å˜ä¸ºå…¬æœ‰ã€‚

å¯¹äºç»“æ„ä½“ï¼Œéœ€è¦å¯¹å†…éƒ¨å­—æ®µä¹Ÿè®¾ç½® pub å±æ€§ï¼›å¯¹äºæšä¸¾ç±»å‹åˆ™ä¸éœ€è¦ï¼Œä»–ä»¬é»˜è®¤éƒ½æ˜¯ pub ç±»å‹ã€‚

å¯ä»¥ä½¿ç”¨ super å…³é”®å­—ç›´æ¥è®¿é—®åˆ°ä¸Šä¸€çº§çš„åŒ…ã€‚

### use å…³é”®å­—

ä½¿ç”¨ use å…³é”®å­—å¯ä»¥ç®€åŒ–è·¯å¾„çš„ä¹¦å†™ï¼š

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}

```

åœ¨ä½œç”¨åŸŸä¸­å¢åŠ  use å’Œè·¯å¾„ç±»ä¼¼äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºè½¯è¿æ¥ï¼ˆç¬¦å·è¿æ¥ï¼Œsymbolic linkï¼‰ã€‚é€šè¿‡åœ¨ crate æ ¹å¢åŠ  use crate::front_of_house::hostingï¼Œç°åœ¨ hosting åœ¨ä½œç”¨åŸŸä¸­å°±æ˜¯æœ‰æ•ˆçš„åç§°äº†ï¼Œå¦‚åŒ hosting æ¨¡å—è¢«å®šä¹‰äº crate æ ¹ä¸€æ ·ã€‚é€šè¿‡ use å¼•å…¥ä½œç”¨åŸŸçš„è·¯å¾„ä¹Ÿä¼šæ£€æŸ¥ç§æœ‰æ€§ï¼ŒåŒå…¶å®ƒè·¯å¾„ä¸€æ ·ã€‚

#### ä½¿ç”¨ as å…³é”®å­—é‡å‘½å

ç›´æ¥çœ‹ä¾‹å­ï¼š

```rust
use std::fmt::Result;
use std::io::Result as IoResult;

fn function1() -> Result {
    // --snip--
    Ok(())
}

fn function2() -> IoResult<()> {
    // --snip--
    Ok(())
}
```

#### pub use æ··ç”¨

ä½¿ç”¨ use å…³é”®å­—ï¼Œå°†æŸä¸ªåç§°å¯¼å…¥å½“å‰ä½œç”¨åŸŸåï¼Œè¿™ä¸ªåç§°åœ¨æ­¤ä½œç”¨åŸŸä¸­å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä½†å®ƒå¯¹æ­¤ä½œç”¨åŸŸä¹‹å¤–è¿˜æ˜¯ç§æœ‰çš„ã€‚å¦‚æœæƒ³è®©å…¶ä»–äººè°ƒç”¨æˆ‘ä»¬çš„ä»£ç æ—¶ï¼Œä¹Ÿèƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨è¿™ä¸ªåç§°ï¼Œå°±å¥½åƒå®ƒæœ¬æ¥å°±åœ¨å½“å‰ä½œç”¨åŸŸä¸€æ ·ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°† pub å’Œ use åˆèµ·æ¥ä½¿ç”¨ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º â€œé‡å¯¼å‡ºï¼ˆre-exportingï¼‰â€ï¼šæˆ‘ä»¬ä¸ä»…å°†ä¸€ä¸ªåç§°å¯¼å…¥äº†å½“å‰ä½œç”¨åŸŸï¼Œè¿˜å…è®¸åˆ«äººæŠŠå®ƒå¯¼å…¥ä»–ä»¬è‡ªå·±çš„ä½œç”¨åŸŸã€‚

```rust
mod front_of_house {
    pub mod hosting {
        pub fn add_to_waitlist() {}
    }
}

pub use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

#### åµŒå¥—è·¯å¾„

åªæ˜¯ä¸€ç§å‡å°‘ä»£ç è¡Œæ•°çš„åŠæ³•ã€‚

```rust
use std::{cmp::Ordering, io};
// ç­‰ä»·äºä¸‹é¢è¿™ä¸¤å¥:
// use std::cmp::Ordering;
// use std::cmp::io;

use std::io::{self, Write};
//  ç­‰ä»·äºä¸‹é¢è¿™ä¸¤å¥:
// use std::io;
// use std::io::Write;
```

## äº”ã€å¸¸è§é›†åˆ

è¿™ä¸€éƒ¨åˆ†ä¸»è¦ä»‹ç»äº† Vector, String, Hashmap çš„ç›¸å…³ä½¿ç”¨ã€‚

### Vector

ç›´æ¥ç”¨ä»£ç ä»‹ç»ä¸‹ APIï¼š

```rust
fn main() {
    // 1.æ–°å»ºvector
    let v: Vec<i32> = Vec::new();
    let v = vec![1, 2, 3];

    // 2.æ·»åŠ å…ƒç´ 
    v.push(5);
    v.push(6);
    v.push(7);
    v.push(8);

    // 3.è·å–å…ƒç´ 
    // 3.1 ä½¿ç”¨ç´¢å¼•ç›´æ¥è·å–ï¼Œæ³¨æ„è¿™é‡Œä¸è·å¾—æ‰€æœ‰æƒã€‚
    let third: &i32 = &v[2];
    println!("The third element is {third}");

    //3.2 get()Â æ–¹æ³•è·å–ï¼Œè¿”å›å€¼æ˜¯Option<&T>æšä¸¾ç±»å‹ã€‚
    let third: Option<&i32> = v.get(2);
    match third {
        Some(third) => println!("The third element is {third}"),
        None => println!("There is no third element."),
    }

    //4. éå†Vector, åŒæ ·ï¼Œéœ€è¦ä½¿ç”¨å¼•ç”¨æ¥é¿å…æ‰€æœ‰æƒçš„å˜åŒ–ã€‚

    let v = vec![100, 32, 57];
    for i in &mut v {
        println!("{i}");
        *i += 10;
    }


}

```

vector åªèƒ½å‚¨å­˜ç›¸åŒç±»å‹çš„å€¼ã€‚è¿™æ˜¯å¾ˆä¸æ–¹ä¾¿çš„ï¼›ç»å¯¹ä¼šæœ‰éœ€è¦å‚¨å­˜ä¸€ç³»åˆ—ä¸åŒç±»å‹çš„å€¼çš„ç”¨ä¾‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œæšä¸¾çš„æˆå‘˜éƒ½è¢«å®šä¹‰ä¸ºç›¸åŒçš„æšä¸¾ç±»å‹ï¼Œæ‰€ä»¥å½“éœ€è¦åœ¨ vector ä¸­å‚¨å­˜ä¸åŒç±»å‹å€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¹¶ä½¿ç”¨ä¸€ä¸ªæšä¸¾ã€‚

```rust
fn main() {
    enum SpreadsheetCell {
        Int(i32),
        Float(f64),
        Text(String),
    }

    let row = vec![
        SpreadsheetCell::Int(3),
        SpreadsheetCell::Text(String::from("blue")),
        SpreadsheetCell::Float(10.12),
    ];
}

```

### String

ç”±äº Rust ä¸­å­˜å‚¨çš„å­—ç¬¦ä¸²æ˜¯ UTF-8 å­—ç¬¦é›†ï¼Œå› æ­¤ä»å­—èŠ‚å­˜å‚¨è§’åº¦æ¥çœ‹å’Œå…¶ä»–è¯­è¨€æœ‰å¾ˆå¤§ä¸åŒã€‚ä½†åŸºæœ¬ API è¿˜æ˜¯ç±»ä¼¼çš„ã€‚ ä¾ç„¶ç”¨ä»£ç ç›´æ¥ç¤ºä¾‹ã€‚

```rust
fn main() {
    // åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²
    let mut s = String::new();

    // strç±»å‹è½¬String
    let mut s = "initial contents".to_string();

    // æ›´æ–°å­—ç¬¦ä¸²
    s.push_str("bar");
    s.push('l');

    // å¦‚æœ push_str æ–¹æ³•ä¸è·å¾—s2çš„æ‰€æœ‰æƒ
    let mut s1 = String::from("foo");
    let s2 = "bar";
    s1.push_str(s2);
    println!("s2 is {s2}");

    // Stringç±»å‹ä¸æ”¯æŒç´¢å¼•ï¼Œå› ä¸ºå®ƒé‡‡ç”¨UTF-8ç¼–ç ï¼Œ
    // ä¸çŸ¥é“å­—èŠ‚æ˜¯æ€ä¹ˆåˆ†é…ç»™å­—ç¬¦çš„

    // s åŒ…å«å­—ç¬¦ä¸²çš„å¤´å››ä¸ªå­—èŠ‚
    let hello = "Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ";
    let s = &hello[0..4];

    // éå†å­—ç¬¦ä¸²
    for c in "Ğ—Ğ´".chars() {
        println!("{c}");
    }


}
```

### Hashmap

æœ‰äº†æ‰€æœ‰æƒçš„é™åˆ¶ï¼ŒHashmap çš„ä½¿ç”¨æ¯”å…¶ä»–è¯­è¨€å¤æ‚ä¸€äº›ã€‚åŒæ ·ï¼Œç›´æ¥çœ‹ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼š

```rust
fn main() {
    use std::collections::HashMap;

    // åˆ›å»ºç©ºhashmap
    let mut scores = HashMap::new();

    // æ·»åŠ é”®å€¼å¯¹
    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Yellow"), 50);

    // get() æ–¹æ³•è·å¾—é”®å¯¹åº”çš„å€¼ã€‚Option<&V>ï¼Œ
    // å¦‚æœæŸä¸ªé”®åœ¨å“ˆå¸Œ map ä¸­æ²¡æœ‰å¯¹åº”çš„å€¼,get ä¼šè¿”å› Noneã€‚
    // ç¨‹åºè°ƒç”¨ copied æ–¹æ³•æ¥è·å–Option<i32>ï¼Œè€Œä¸æ˜¯ Option<&i32>,
    // æ¥ç€è°ƒç”¨ unwrap_or åœ¨ scores ä¸­æ²¡æœ‰è¯¥é”®æ‰€å¯¹åº”çš„é¡¹æ—¶å°†å…¶è®¾ç½®ä¸ºé›¶ã€‚
    let team_name = String::from("Blue");
    let score = scores.get(&team_name).copied().unwrap_or(0);

    // éå†hashmap
    for (key, value) in &scores {
        println!("{key}: {value}");
    }

    // entryä½¿ç”¨æˆ‘ä»¬æƒ³è¦æ£€æŸ¥çš„é”®ä½œä¸ºå‚æ•°ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæšä¸¾Entryï¼Œ
    // å®ƒä»£è¡¨äº†å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨çš„å€¼ã€‚
    // Entry çš„ or_insert æ–¹æ³•åœ¨é”®å¯¹åº”çš„å€¼å­˜åœ¨æ—¶å°±è¿”å›è¿™ä¸ªå€¼çš„å¯å˜å¼•ç”¨ï¼Œ
    // å¦‚æœä¸å­˜åœ¨åˆ™å°†å‚æ•°ä½œä¸ºæ–°å€¼æ’å…¥å¹¶è¿”å›æ–°å€¼çš„å¯å˜å¼•ç”¨ã€‚
    scores.entry(String::from("Red")).or_insert(100);


    // ä¸€ä¸ªä¾‹å­ï¼šå•è¯è®¡æ•°ï¼Œç»Ÿè®¡ä¸€äº›æ–‡æœ¬ä¸­æ¯ä¸€ä¸ªå•è¯åˆ†åˆ«å‡ºç°äº†å¤šå°‘æ¬¡ã€‚
    let text = "hello world wonderful world";

    let mut map = HashMap::new();

    for word in text.split_whitespace() {
        let count = map.entry(word).or_insert(0);
        *count += 1;
    }

}

```
